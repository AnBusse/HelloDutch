{% extends "base.html.twig" %}

{% block title %}HelloDutch{% endblock %}
{% block head %}
    {{ parent() }}
    <style type="text/css">
        .important { color: #336699; }
    </style>
{% endblock %}
{% block home_content %}
    <h1>Welcome!</h1>

    <div>
        <div id="map"></div>
    </div>
    <script>
        var map;
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: 52.37403, lng: 4.88969},
                zoom: 6.8
            });

            // Create a <script> tag and set the USGS URL as the source.
            var script = document.createElement('script');
            map.data.loadGeoJson('/geodata/provinces.geojson');

            // Set the global styles.
            map.data.setStyle({
                strokeWeight: 2,
                clickable: true
            });

            map.data.addListener('click', function(event) {
                map.data.overrideStyle(event.feature, {fillColor: 'orange'});

                    var pos = {
                        lat: event.latLng.lat(),
                        lng: event.latLng.lng()
                    };

                infoWindow = new google.maps.InfoWindow;


                    infoWindow.setPosition(pos);
                    infoWindow.setContent('Location found.');
                    infoWindow.open(map);
                    map.setCenter(pos);

            });

              //  console.log(pos);

                map.data.addListener('rightclick', function(event) {
                map.data.overrideStyle(event.feature, {fillColor: 'none'});
                map.data.removeProperty();
            });

            window.eqfeed_callback = function (results) {
                for (var i = 0; i < results.features.length; i++) {
                    var coords = results.features[i].geometry.coordinates;
                    var latLng = new google.maps.LatLng(coords[1], coords[0]);
                    var marker = new google.maps.Marker({
                        position: latLng,
                        map: map
                    });
                }

            }
        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDz1jPdAPhKnEgWFqYMt9x55-gA1l0yBcA&callback=initMap"
            async defer></script>
    {%  if is_granted('ROLE_USER') %}

        {# do stuff #}

    {% else %}
        <p>Please <a href="{{ path('fos_user_security_login') }}">Login</a>
            or <a href="{{ path('fos_user_registration_register') }}">Register</a>
            to proceed.
        </p>
    {% endif %}
{% endblock %}